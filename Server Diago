import ballerina/sql;
import ballerinax/mysql;
import ballerina/log;

const string DB_URL = "jdbc:mysql://localhost:3306/logisticsDB";
const string DB_USER = "root";
const string DB_PASSWORD = "password";

function fetchLocationDistance(string areaName) returns int|error {
    mysql:Client dbClient = check new (DB_URL, DB_USER, DB_PASSWORD);

    int locationDistance = 0;
    sql:ParameterizedQuery query = `SELECT distance FROM locations WHERE areaName = ${areaName}`;

    stream<record {| int distance; |}, sql:Error> resultStream = dbClient->query(query);

    error? e = resultStream.forEach(function(record {| int distance; |} result) {
        locationDistance = result.distance;
    });

    check dbClient.close();
    return locationDistance;
}

public function main() returns error? {
    string areaName = "Downtown";
    int fetchedLocationDistance = check fetchLocationDistance(areaName);
    log:printInfo("Fetched Location Distance: " + fetchedLocationDistance.toString());
}
